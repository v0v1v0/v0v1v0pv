<div class="container">

<table style="width: 100%;"><tr>
<td>multipart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiplicative Diversity Partitioning</h2>

<h3>Description</h3>

<p>In multiplicative diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set or the pooled samples (gamma diversity).
</p>


<h3>Usage</h3>

<pre><code class="language-R">multipart(...)
## Default S3 method:
multipart(y, x, index=c("renyi", "tsallis"), scales = 1,
    global = FALSE, relative = FALSE, nsimul=99, method = "r2dtable", ...)
## S3 method for class 'formula'
multipart(formula, data, index=c("renyi", "tsallis"), scales = 1,
    global = FALSE, relative = FALSE, nsimul=99, method = "r2dtable", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A community matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix with same number of rows as in <code>y</code>, columns
coding the levels of sampling hierarchy. The number of groups within
the hierarchy must decrease from left to right. If <code>x</code> is missing,
two levels are assumed: each row is a group in the first level, and
all rows are in the same group in the second level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A two sided model formula in the form <code>y ~ x</code>,
where <code>y</code> is the community data matrix with samples as rows and
species as column. Right hand side (<code>x</code>) must be grouping
variable(s) referring to levels of sampling hierarchy, terms from
right to left will be treated as nested (first column is the lowest,
last is the highest level). The formula will add a unique
indentifier to rows and constant for the rows to always produce
estimates of row-level alpha and overall gamma diversities. You must
use non-formula interface to avoid this behaviour. Interaction terms
are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame where to look for variables defined in the
right hand side of <code>formula</code>. If missing, variables are looked
in the global environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Character, the entropy index to be calculated (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>Logical, if <code>TRUE</code> then beta diversity is
standardized by its maximum (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>Numeric, of length 1, the order of the generalized
diversity index to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global</code></td>
<td>
<p>Logical, indicates the calculation of beta diversity values,
see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsimul</code></td>
<td>
<p>Number of permutations to use.  If <code>nsimul = 0</code>,
only the <code>FUN</code> argument is evaluated.
It is thus possible to reuse the statistic values
without a null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Null model method: either a name (character string) of
a method defined in <code>make.commsim</code> or a
<code>commsim</code> function.
The default <code>"r2dtable"</code> keeps row sums and column sums fixed.
See <code>oecosimu</code> for Details and Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>oecosimu</code>, i.e.
<code>method</code>, <code>thin</code> or <code>burnin</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiplicative diversity partitioning is based on Whittaker's (1972) ideas,
that has recently been generalised to one parametric diversity families
(i.e. Rényi and Tsallis) by Jost (2006, 2007).
Jost recommends to use the numbers equivalents (Hill numbers),
instead of pure diversities, and proofs, that this satisfies the
multiplicative partitioning requirements.
</p>
<p>The current implementation of <code>multipart</code> calculates Hill numbers
based on the functions <code>renyi</code> and <code>tsallis</code>
(provided as <code>index</code> argument).
If values for more than one <code>scales</code> are desired,
it should be done in separate runs, because it adds extra dimensionality
to the implementation, which has not been resolved efficiently.
</p>
<p>Alpha diversities are then the averages of these Hill numbers for
each hierarchy levels, the global gamma diversity is the alpha value
calculated for the highest hierarchy level.
When <code>global = TRUE</code>, beta is calculated relative to the global gamma value:
</p>
<p style="text-align: center;"><code class="reqn">\beta_i = \gamma / \alpha_{i}</code>
</p>

<p>when <code>global = FALSE</code>, beta is calculated relative to local
gamma values (local gamma means the diversity calculated for a particular
cluster based on the pooled abundance vector):
</p>
<p style="text-align: center;"><code class="reqn">\beta_ij = \alpha_{(i+1)j} / mean(\alpha_{ij})</code>
</p>

<p>where <code class="reqn">j</code> is a particular cluster at hierarchy level <code class="reqn">i</code>.
Then beta diversity value for level <code class="reqn">i</code> is the mean of the beta
values of the clusters at that level, <code class="reqn">\beta_{i} = mean(\beta_{ij})</code>.
</p>
<p>If <code>relative = TRUE</code>, the respective beta diversity values are
standardized by their maximum possible values (<code class="reqn">mean(\beta_{ij}) / \beta_{max,ij}</code>)
given as <code class="reqn">\beta_{max,ij} = n_{j}</code> (the number of lower level units
in a given cluster <code class="reqn">j</code>).
</p>
<p>The expected diversity components are calculated <code>nsimul</code>
times by individual based randomization of the community data matrix.
This is done by the <code>"r2dtable"</code> method in <code>oecosimu</code> by default.
</p>


<h3>Value</h3>

<p>An object of class <code>"multipart"</code> with same structure as
<code>"oecosimu"</code> objects.
</p>


<h3>Author(s)</h3>

<p>Péter Sólymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a></p>


<h3>References</h3>

<p>Jost, L. (2006). Entropy and diversity.
<em>Oikos</em>, <b>113</b>, 363–375.
</p>
<p>Jost, L. (2007). Partitioning diversity into independent alpha and beta components.
<em>Ecology</em>, <b>88</b>, 2427–2439.
</p>
<p>Whittaker, R. (1972). Evolution and measurement of species diversity.
<em>Taxon</em>, <b>21</b>, 213–251.
</p>


<h3>See Also</h3>

<p>See <code>adipart</code> for additive diversity partitioning,
<code>hiersimu</code> for hierarchical null model testing
and <code>oecosimu</code> for permutation settings and calculating <code class="reqn">p</code>-values.</p>


<h3>Examples</h3>

<pre><code class="language-R">## NOTE: 'nsimul' argument usually needs to be &gt;= 99
## here much lower value is used for demonstration

data(mite)
data(mite.xy)
data(mite.env)
## Function to get equal area partitions of the mite data
cutter &lt;- function (x, cut = seq(0, 10, by = 2.5)) {
    out &lt;- rep(1, length(x))
    for (i in 2:(length(cut) - 1))
        out[which(x &gt; cut[i] &amp; x &lt;= cut[(i + 1)])] &lt;- i
    return(out)}
## The hierarchy of sample aggregation
levsm &lt;- with(mite.xy, data.frame(
    l2=cutter(y, cut = seq(0, 10, by = 2.5)),
    l3=cutter(y, cut = seq(0, 10, by = 5))))
## Multiplicative diversity partitioning
multipart(mite, levsm, index="renyi", scales=1, nsimul=19)
multipart(mite ~ l2 + l3, levsm, index="renyi", scales=1, nsimul=19)
multipart(mite ~ ., levsm, index="renyi", scales=1, nsimul=19, relative=TRUE)
multipart(mite ~ ., levsm, index="renyi", scales=1, nsimul=19, global=TRUE)
</code></pre>


</div>