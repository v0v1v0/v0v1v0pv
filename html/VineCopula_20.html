<div class="container">

<table style="width: 100%;"><tr>
<td>BiCopChiPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chi-plot for Bivariate Copula Data</h2>

<h3>Description</h3>

<p>This function creates a chi-plot of given bivariate copula data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BiCopChiPlot(u1, u2, PLOT = TRUE, mode = "NULL", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u1, u2</code></td>
<td>
<p>Data vectors of equal length with values in <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PLOT</code></td>
<td>
<p>Logical; whether the results are plotted. If <code>PLOT = FALSE</code>, the values <code>lambda</code>, <code>chi</code> and <code>control.bounds</code> are
returned (see below; default: <code>PLOT = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Character; whether a general, lower or upper chi-plot is
calculated.  Possible values are <code>mode = "NULL"</code>, <code>"upper"</code> and
<code>"lower"</code>. <br><code>"NULL"</code> = general chi-plot (default)<br><code>"upper"</code> = upper chi-plot<br><code>"lower"</code> = lower chi-plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plot arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For observations <code class="reqn">u_{i,j},\ i=1,...,N,\ j=1,2,</code> the chi-plot is based on the following two quantities: the
chi-statistics
</p>
<p style="text-align: center;"><code class="reqn">\chi_i = \frac{\hat{F}_{1,2}(u_{i,1},u_{i,2})
- \hat{F}_{1}(u_{i,1})\hat{F}_{2}(u_{i,2})}{
\sqrt{\hat{F}_{1}(u_{i,1})(1-\hat{F}_{1}(u_{i,1}))
\hat{F}_{2}(u_{i,2})(1-\hat{F}_{2}(u_{i,2}))}}, </code>
</p>

<p>and the lambda-statistics
</p>
<p style="text-align: center;"><code class="reqn">\lambda_i = 4 sgn\left( \tilde{F}_{1}(u_{i,1}),\tilde{F}_{2}(u_{i,2}) \right)
\cdot \max\left( \tilde{F}_{1}(u_{i,1})^2,\tilde{F}_{2}(u_{i,2})^2 \right), </code>
</p>

<p>where <code class="reqn">\hat{F}_{1}</code>, <code class="reqn">\hat{F}_{2}</code> and
<code class="reqn">\hat{F}_{1,2}</code> are the empirical distribution functions
of the uniform random variables <code class="reqn">U_1</code> and <code class="reqn">U_2</code> and of
<code class="reqn">(U_1,U_2)</code>, respectively. Further,
<code class="reqn">\tilde{F}_{1}=\hat{F}_{1}-0.5</code> and
<code class="reqn">\tilde{F}_{2}=\hat{F}_{2}-0.5</code>.
</p>
<p>These quantities only depend on the ranks of the data and are scaled to the
interval <code class="reqn">[0,1]</code>. <code class="reqn">\lambda_i</code> measures a distance of a data point
<code class="reqn">\left(u_{i,1},u_{i,2}\right)</code> to the center of the
bivariate data set, while <code class="reqn">\chi_i</code> corresponds to a correlation
coefficient between dichotomized values of <code class="reqn">U_1</code> and <code class="reqn">U_2</code>. Under
independence it holds that <code class="reqn">\chi_i \sim
\mathcal{N}(0,\frac{1}{N})</code> and <code class="reqn">\lambda_i \sim
\mathcal{U}[-1,1]</code> asymptotically, i.e., values of
<code class="reqn">\chi_i</code> close to zero indicate independenceâ€”corresponding to
<code class="reqn">F_{1, 2}=F_{1}F_{2}</code>.
</p>
<p>When plotting these quantities, the pairs of <code class="reqn">\left(\lambda_i, \chi_i
\right)</code> will tend to be located above zero for
positively dependent margins and vice versa for negatively dependent
margins. Control bounds around zero indicate whether there is significant
dependence present.
</p>
<p>If <code>mode = "lower"</code> or <code>"upper"</code>, the above quantities are
calculated only for those <code class="reqn">u_{i,1}</code>'s and <code class="reqn">u_{i,2}</code>'s which are
smaller/larger than the respective means of
<code>u1</code><code class="reqn">=(u_{1,1},...,u_{N,1})</code> and
<code>u2</code><code class="reqn">=(u_{1,2},...,u_{N,2})</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Lambda-statistics (x-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>Chi-statistics
(y-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.bounds</code></td>
<td>
<p>A 2-dimensional vector of bounds
<code class="reqn">((1.54/\sqrt{n},-1.54/\sqrt{n})</code>, where <code class="reqn">n</code> is the length of
<code>u1</code> and where the chosen values correspond to an approximate
significance level of <code class="reqn">10\%</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Natalia Belgorodski, Ulf Schepsmeier
</p>


<h3>References</h3>

<p>Abberger, K. (2004). A simple graphical method to explore
tail-dependence in stock-return pairs. Discussion Paper, University of
Konstanz, Germany.
</p>
<p>Genest, C. and A. C. Favre (2007). Everything you always wanted to know
about copula modeling but were afraid to ask. Journal of Hydrologic
Engineering, 12 (4), 347-368.
</p>


<h3>See Also</h3>

<p><code>BiCopMetaContour()</code>, <code>BiCopKPlot()</code>,
<code>BiCopLambda()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## chi-plots for bivariate Gaussian copula data

# simulate copula data
fam &lt;- 1
tau &lt;- 0.5
par &lt;- BiCopTau2Par(fam, tau)
cop &lt;- BiCop(fam, par)
set.seed(123)
dat &lt;- BiCopSim(500, cop)

# create chi-plots
op &lt;- par(mfrow = c(1, 3))
BiCopChiPlot(dat[,1], dat[,2], xlim = c(-1,1), ylim = c(-1,1),
             main="General chi-plot")
BiCopChiPlot(dat[,1], dat[,2], mode = "lower", xlim = c(-1,1),
             ylim = c(-1,1), main = "Lower chi-plot")
BiCopChiPlot(dat[,1], dat[,2], mode = "upper", xlim = c(-1,1),
             ylim = c(-1,1), main = "Upper chi-plot")
par(op)

</code></pre>


</div>