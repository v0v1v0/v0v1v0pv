<div class="container">

<table style="width: 100%;"><tr>
<td>yulesimonMlink</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Link functions for the mean of 1–parameter 
discrete distributions: The Yule–Simon Distribution.
</h2>

<h3>Description</h3>

<p>Computes the <code>yulesimonMlink</code> transformation, its inverse
and the first two derivatives.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
 yulesimonMlink(theta, bvalue = NULL, inverse = FALSE, 
                deriv = 0, short = TRUE, tag = FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Numeric or character. This is <code class="reqn">\theta</code> by default,
or <code class="reqn">\eta</code> depending upon other arguments. 
See <code>Links</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bvalue, inverse, deriv, short, tag</code></td>
<td>

<p>Details at <code>Links</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assume <code class="reqn">Y \sim {\rm{Yule-Simon}}(\rho) </code>, 
where <code class="reqn">\rho</code> is a shape parameter as in
<code>yulesimon</code>.
Then, the mean of <code class="reqn">Y</code> 
is given by

</p>
<p style="text-align: center;"><code class="reqn">\mu = \frac{\rho}{\rho - 1} = (1 - \rho^{-1})^{-1},
  </code>
</p>


<p>provided <code class="reqn"> \rho &gt; 1 </code>.
</p>
<p>This link function may be conceived as a natural link function 
for the mean of the Yule–Simon distribution which comes up by 
taking the logarithm on both sides of this equation. More precisely, 
the <code>yulesimonMlink</code> tranformation for <code class="reqn">\rho &gt; 1</code>
is given by

</p>
<p style="text-align: center;"><code class="reqn"> {\tt{yulesimonMlink}}(\rho) = - \log (1 - \rho^{-1}).</code>
</p>


<p>While this link function can be used to model any parameter lying in 
<code class="reqn">(1, \infty)</code>, it is particularly useful for event-rate data where
the mean, <code class="reqn">\mu</code>, can be written in terms of some rate of events,
say <code class="reqn">\lambda</code>, and the timeframe observed <code class="reqn">t</code>. 
Specifically,

</p>
<p style="text-align: center;"><code class="reqn">\mu = \lambda t.</code>
</p>


<p>Assuming that additional covariates might be available to linearly 
model <code class="reqn">\lambda</code> (or <code class="reqn">\log \lambda</code>), 
this model can be treated as a VGLM with one parameter where
the time <code class="reqn">t</code> (as <code class="reqn">\log t</code>) can be easily incorporated 
in the analysis as an offset.
</p>
<p>Under this link function the domain set for <code class="reqn">\rho</code> 
is <code class="reqn">(1, \infty)</code>. Hence, values of <code class="reqn">\rho</code> too 
close to <code class="reqn">1</code> from the right, or out of range will result 
in <code>Inf</code>, <code>-Inf</code>, <code>NA</code> or <code>NaN</code>. 
Use argument <code>bvalue</code> to adequately replace them before 
computing the link function.



</p>
<p>Unlike <code>logffMlink</code> or
<code>zetaffMlink</code>, the inverse of
this link function can be written in close form.
</p>
<p>If <code>theta</code> is a character, arguments <code>inverse</code> and 
<code>deriv</code> are disregarded.
</p>


<h3>Value</h3>

<p>For <code>deriv = 0</code>, the <code>yulesimonMlink</code> transformation of
<code>theta</code> when <code>inverse = FALSE</code>, and if 
<code>inverse = TRUE</code> then 
<code>exp(theta) / (exp(theta) - 1)</code>.
</p>
<p>For <code>deriv = 1</code>, <em>d</em> <code>eta</code> / <em>d</em> <code>theta</code> 
as a function of <code>theta</code> if <code>inverse = FALSE</code>, else 
the reciprocal <em>d</em> <code>theta</code> / <em>d</em> <code>eta</code>.
</p>
<p>For <code>deriv = 2</code> the second order derivatives 
are correspondingly returned.
</p>


<h3>Warning</h3>

<p>Conforming with <code>yulesimon</code>, the domain 
set for <code class="reqn">rho</code> is <code class="reqn">(0, \infty)</code>. However, in order for 
<code>yulesimonMlink</code> to be a real number, <code class="reqn">rho</code> must be greater 
then 1.0. Then, when a VGLM is fitted via 
<code>yulesimon</code> using this link function, 
numerical instability will occur if the estimated or the true value of
<code class="reqn">rho</code> lies between 0 and 1, or if the initial values for <code class="reqn">rho</code> 
generated by
<code>yulesimon</code> fail to meet
<code class="reqn">rho &gt; 1</code>. Alternatively, try 
<code>posPoiMlink</code> or
<code>loglink</code> if this happens.
</p>


<h3>Note</h3>

<p>If the underlying assumption <code class="reqn">\rho &gt; 1</code> is not met,
then this function returns <code>NaN</code>. 
This is equivalent to claim that the mean is infinite or negative 
and, consequently, its logarithm will not be real.
</p>
<p>The vertical line <code>theta = 1</code> is an asymptote for this link 
function. As a result, it may return <code>Inf</code> for values of 
<code class="reqn">\rho</code> too close to <code class="reqn">1</code> from the right.
</p>


<h3>Author(s)</h3>

<p>V. Miranda and T. W. Yee
</p>


<h3>See Also</h3>

<p><code>yulesimon</code>,
<code>Links</code>, 
<code>posPoiMlink</code>,
<code>loglink</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Example 1  ##
Shapes &lt;- 1:10 
yulesimonMlink(theta = Shapes, deriv = 1)  ## d eta/d theta, as function of theta

yulesl.inv &lt;- 
    # The inverse  minus actual values
    yulesimonMlink(theta = yulesimonMlink(theta = Shapes),  inverse = TRUE) - Shapes
                      
summary(yulesl.inv)     ## zero


## Example 2. Special values of theta (rho) ##
rhos &lt;- c(-Inf, -2, -1, 0.0, 0.5, 1, 5, 10, 100, Inf, NaN, NA) 
rbind(rho = rhos, 
      yuleslink  = yulesimonMlink(theta = rhos),
      inv.yulesl =yulesimonMlink(theta = rhos, inverse = TRUE))


## Example 3 The yulesimonMlink transformation and the first two derivatives ##


rhos &lt;- seq(1, 20, by = 0.01)[-1]
y.rhos &lt;- yulesimonMlink(theta = rhos, deriv = 0)
der.1  &lt;- yulesimonMlink(theta = rhos, deriv = 1)
der.2  &lt;- yulesimonMlink(theta = rhos, deriv = 2)

plot(y.rhos ~ rhos, col = "black", 
     main = "log(mu), mu = E[Y], Y ~ Yule-Simon(rho).",
     ylim = c(-5, 10), xlim = c(-1, 5), lty = 1, type = "l", lwd = 3)
abline(v = 1.0, col = "orange", lty = 2, lwd = 3)
abline(v = 0, h = 0, col = "gray50", lty = "dashed")

lines(rhos, der.1, col = "blue", lty = 5)
lines(rhos, der.2, col = "chocolate", lty = 4)
legend(2, 7, legend = c("yulesimonMlink", "deriv = 1", "deriv = 2"),
       col = c("black", "blue", "chocolate"), lty = c(1, 5, 4))
 
</code></pre>


</div>