<div class="container">

<table style="width: 100%;"><tr>
<td>vardchanges</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance estimation for measures of change for single and multistage stage cluster sampling designs</h2>

<h3>Description</h3>

<p>Computes the variance estimation for measures of change for single and multistage stage cluster sampling designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vardchanges(
  Y,
  H,
  PSU,
  w_final,
  ID_level1,
  ID_level2,
  Dom = NULL,
  Z = NULL,
  gender = NULL,
  country = NULL,
  period,
  dataset = NULL,
  period1,
  period2,
  X = NULL,
  countryX = NULL,
  periodX = NULL,
  X_ID_level1 = NULL,
  ind_gr = NULL,
  g = NULL,
  q = NULL,
  datasetX = NULL,
  linratio = FALSE,
  percentratio = 1,
  use.estVar = FALSE,
  outp_res = FALSE,
  confidence = 0.95,
  change_type = "absolute",
  checking = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Variables of interest. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The unit stratum variable. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSU</code></td>
<td>
<p>Primary sampling unit variable. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_final</code></td>
<td>
<p>Weight variable. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_level1</code></td>
<td>
<p>Variable for level1 ID codes. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_level2</code></td>
<td>
<p>Optional variable for unit ID codes. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dom</code></td>
<td>
<p>Optional variables used to define population domains. If supplied, variables are calculated for each domain. An object convertible to <code>data.table</code> or variable names as character vector, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Optional variables of denominator for ratio estimation. If supplied, the ratio estimation is computed. Object convertible to <code>data.table</code> or variable names as character, column numbers. This variable is <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gender</code></td>
<td>
<p>Numerical variable for gender, where 1 is for males, but 2 is for females. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country</code></td>
<td>
<p>Variable for the survey countries. The values for each country are computed independently. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Variable for the all survey periods. The values for each period are computed independently. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Optional survey data object convertible to <code>data.table</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period1</code></td>
<td>
<p>The vector of periods from variable <code>periods</code> describes the first period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period2</code></td>
<td>
<p>The vector of periods from variable <code>periods</code> describes the second period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Optional matrix of the auxiliary variables for the calibration estimator. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>countryX</code></td>
<td>
<p>Optional variable for the survey countries. The values for each country are computed independently. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodX</code></td>
<td>
<p>Optional variable of the all survey periods. If supplied, residual estimation of calibration is done independently for each time period. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_ID_level1</code></td>
<td>
<p>Variable for level1 ID codes. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_gr</code></td>
<td>
<p>Optional variable by which divided independently X matrix of the auxiliary variables for the calibration. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Optional variable of the g weights. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Variable of the positive values accounting for heteroscedasticity. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datasetX</code></td>
<td>
<p>Optional survey data object in household level convertible to <code>data.table</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linratio</code></td>
<td>
<p>Logical value. If value is <code>TRUE</code>, then the linearized variables for the ratio estimator is used for variance estimation. If value is <code>FALSE</code>, then the gradients is used for variance estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentratio</code></td>
<td>
<p>Positive numeric value. All linearized variables are multiplied with <code>percentratio</code> value, by default - 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.estVar</code></td>
<td>
<p>Logical value. If value is <code>TRUE</code>, then <code>R</code> function <code>estVar</code> is used for the  estimation of covariance matrix of the residuals. If value is <code>FALSE</code>, then <code>R</code> function <code>estVar</code> is not used for the  estimation of covariance matrix of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outp_res</code></td>
<td>
<p>Logical value. If <code>TRUE</code> estimated residuals of calibration will be printed out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>optional; either a positive value for confidence interval. This variable by default is 0.95 .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>change_type</code></td>
<td>
<p>character value net changes type - absolute or relative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checking</code></td>
<td>
<p>Optional variable if this variable is TRUE, then function checks data preparation errors, otherwise not checked. This variable by default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with objects are returned by the function:
</p>

<ul>
<li> <p><code>res_out</code> - a <code>data.table</code> containing the estimated residuals of calibration with ID_level1 and PSU by periods and countries (if available).
#'     </p>
</li>
<li> <p><code>crossectional_results</code> - a <code>data.table</code> containing: <br><code>period</code> -  survey periods, <br><code>country</code> - survey countries, <br><code>Dom</code> - optional variable of the population domains, <br><code>namesY</code> - variable with names of variables of interest, <br><code>namesZ</code> - optional variable with names of denominator for ratio estimation, <br><code>sample_size</code> - the sample size (in numbers of individuals), <br><code>pop_size</code> - the population size (in numbers of individuals), <br><code>total</code> - the estimated totals, <br><code>variance</code> - the estimated variance of cross-sectional or longitudinal measures, <br><code>sd_w</code> - the estimated weighted variance of simple random sample, <br><code>sd_nw</code> - the estimated variance estimation of simple random sample, <br><code>pop</code> - the population size (in numbers of households), <br><code>sampl_siz</code> - the sample size (in numbers of households), <br><code>stderr_w</code> - the estimated weighted standard error of simple random sample, <br><code>stderr_nw</code> - the estimated standard error of simple random sample, <br><code>se</code> - the estimated standard error of cross-sectional or longitudinal, <br><code>rse</code> - the estimated relative standard error (coefficient of variation), <br><code>cv</code> - the estimated relative standard error (coefficient of variation) in percentage, <br><code>absolute_margin_of_error</code> - the estimated absolute margin of error, <br><code>relative_margin_of_error</code> - the estimated relative margin of error, <br><code>CI_lower</code> - the estimated confidence interval lower bound, <br><code>CI_upper</code> - the estimated confidence interval upper bound.
#'     </p>
</li>
<li> <p><code>crossectional_var_grad</code> - a <code>data.table</code> containing: <br><code>periods</code> -  survey periods, <br><code>country</code> - survey countries, <br><code>Dom</code> - optional variable of the population domains, <br><code>namesY</code> - variable with names of variables of interest, <br><code>namesZ</code> - optional variable with names of denominator for ratio estimation, <br><code>grad</code> - the estimated gradient, <br><code>var</code> - the estimated a design-based variance.
</p>
</li>
<li> <p><code>rho</code> - a <code>data.table</code> containing: <br><code>periods_1</code> -  survey periods of <code>periods1</code>, <br><code>periods_2</code> -  survey periods of <code>periods2</code>, <br><code>country</code> - survey countries, <br><code>Dom</code> - optional variable of the population domains, <br><code>namesY</code> - variable with names of variables of interest, <br><code>namesZ</code> - optional variable with names of denominator for ratio estimation, <br><code>nams</code> - the variable names in correlation matrix, <br><code>rho</code> - the estimated correlation matrix.
</p>
</li>
<li> <p><code>var_tau</code> - a <code>data.table</code> containing: <br><code>periods_1</code> -  survey periods of <code>periods1</code>, <br><code>periods_2</code> -  survey periods of <code>periods2</code>, <br><code>country</code> - survey countries, <br><code>Dom</code> - optional variable of the population domains, <br><code>namesY</code> - variable with names of variables of interest, <br><code>namesZ</code> - optional variable with names of denominator for ratio estimation, <br><code>nams</code> - the variable names in correlation matrix, <br><code>var_tau</code> - the estimated covariance matrix.
</p>
</li>
<li> <p><code>changes_results</code> - a <code>data.table</code> containing: <br><code>periods_1</code> -  survey periods of <code>periods1</code>, <br><code>periods_2</code> -  survey periods of <code>periods2</code>, <br><code>country</code> - survey countries, <br><code>Dom</code> - optional variable of the population domains, <br><code>namesY</code> - variable with names of variables of interest, <br><code>namesZ</code> - optional variable with names of denominator for ratio estimation, <br><code>estim_1</code> - the estimated value for period1, <br><code>estim_2</code> - the estimated value for period2, <br><code>estim</code> - the estimated value, <br><code>var</code> - the estimated variance, <br><code>se</code> - the estimated standard error, <br><code>CI_lower</code> - the estimated confidence interval lower bound, <br><code>CI_upper</code> - the estimated confidence interval upper bound. <br><code>significant</code> - is the the difference significant.
</p>
</li>
</ul>
<h3>References</h3>

<p>Guillaume Osier,  Yves Berger,  Tim Goedeme, (2013), Standard error estimation for the EU-SILC indicators of poverty and social exclusion,  Eurostat Methodologies and Working papers, URL <a href="http://ec.europa.eu/eurostat/documents/3888793/5855973/KS-RA-13-024-EN.PDF">http://ec.europa.eu/eurostat/documents/3888793/5855973/KS-RA-13-024-EN.PDF</a>. <br>
Eurostat Methodologies and Working papers, Handbook on precision requirements and variance estimation for ESS household surveys, 2013, URL <a href="http://ec.europa.eu/eurostat/documents/3859598/5927001/KS-RA-13-029-EN.PDF">http://ec.europa.eu/eurostat/documents/3859598/5927001/KS-RA-13-029-EN.PDF</a>. <br>
Yves G. Berger, Tim Goedeme, Guillame Osier (2013). Handbook on standard error estimation and other related sampling issues in EU-SILC, URL <a href="https://ec.europa.eu/eurostat/cros/content/handbook-standard-error-estimation-and-other-related-sampling-issues-ver-29072013_en">https://ec.europa.eu/eurostat/cros/content/handbook-standard-error-estimation-and-other-related-sampling-issues-ver-29072013_en</a> <br></p>


<h3>See Also</h3>

<p><code>domain</code>,
<code>vardcros</code>,
<code>vardchangespoor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example 
library("data.table")
library("laeken")
data("eusilc")
set.seed(1)
eusilc1 &lt;- eusilc[1:40,]
set.seed(1)
dataset1 &lt;- data.table(rbind(eusilc1, eusilc1),
                       year = c(rep(2010, nrow(eusilc1)),
                                rep(2011, nrow(eusilc1))))
dataset1[age &lt; 0, age := 0]
PSU &lt;- dataset1[, .N, keyby = "db030"][, N := NULL]
PSU[, PSU := trunc(runif(nrow(PSU), 0, 5))]
dataset1 &lt;- merge(dataset1, PSU, all = TRUE, by = "db030")
PSU &lt;- eusilc &lt;- NULL
dataset1[, strata := c("XXXX")]

dataset1[, t_pov := trunc(runif(nrow(dataset1), 0, 2))]
dataset1[, exp := 1]

# At-risk-of-poverty (AROP)
dataset1[, pov := ifelse (t_pov == 1, 1, 0)]
dataset1[, id_lev2 := paste0("V", .I)]


result &lt;- vardchanges(Y = "pov", H = "strata", 
                      PSU = "PSU", w_final = "rb050",
                      ID_level1 = "db030", ID_level2 = "id_lev2",
                      Dom = NULL, Z = NULL, period = "year",
                      dataset = dataset1, period1 = 2010,
                      period2 = 2011, change_type = "absolute")
result

## Not run: 
data("eusilc")
dataset1 &lt;- data.table(rbind(eusilc, eusilc),
                       year = c(rep(2010, nrow(eusilc)),
                                rep(2011, nrow(eusilc))))
dataset1[age &lt; 0, age := 0]
PSU &lt;- dataset1[,.N, keyby = "db030"][, N := NULL]
PSU[, PSU := trunc(runif(nrow(PSU), 0, 100))]
dataset1 &lt;- merge(dataset1, PSU, all = TRUE, by = "db030")
PSU &lt;- eusilc &lt;- NULL
dataset1[, strata := "XXXX"]
  
dataset1[, t_pov := trunc(runif(nrow(dataset1), 0, 2))]
dataset1[, t_dep := trunc(runif(nrow(dataset1), 0, 2))]
dataset1[, t_lwi := trunc(runif(nrow(dataset1), 0, 2))]
dataset1[, exp := 1]
dataset1[, exp2 := 1 * (age &lt; 60)]
  
# At-risk-of-poverty (AROP)
dataset1[, pov := ifelse (t_pov == 1, 1, 0)]
  
# Severe material deprivation (DEP)
dataset1[, dep := ifelse (t_dep == 1, 1, 0)]
  
# Low work intensity (LWI)
dataset1[, lwi := ifelse (t_lwi == 1 &amp; exp2 == 1, 1, 0)]
  
# At-risk-of-poverty or social exclusion (AROPE)
dataset1[, arope := ifelse (pov == 1 | dep == 1 | lwi == 1, 1, 0)]
dataset1[, dom := 1]
dataset1[, id_lev2 := .I]
  
result &lt;- vardchanges(Y = c("pov", "dep", "lwi", "arope"),
                      H = "strata", PSU = "PSU", w_final = "rb050",
                      ID_level1 = "db030", ID_level2 = "id_lev2",
                      Dom = "rb090", Z = NULL, period = "year",
                      dataset = dataset1, period1 = 2010, 
                      period2 = 2011, change_type = "absolute")
result
## End(Not run)

</code></pre>


</div>