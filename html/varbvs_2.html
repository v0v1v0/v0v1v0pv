<div class="container">

<table style="width: 100%;"><tr>
<td>varbvsbf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute numerical estimate of Bayes factor.</h2>

<h3>Description</h3>

<p>The Bayes factor is the ratio of the marginal likelihoods
under two different models (see Kass &amp; Raftery, 1995). Function
<code>varbvsbf</code> provides a convenient interface for computing the
Bayes factor comparing the fit of two different <code>varbvs</code> models.</p>


<h3>Usage</h3>

<pre><code class="language-R">  varbvsbf (fit0, fit1)  

  bayesfactor (logw0, logw1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit0</code></td>
<td>
<p>An output returned from <code>varbvs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit1</code></td>
<td>
<p>Another output returned from <code>varbvs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logw0</code></td>
<td>
<p>log-probabilities or log-importance weights under H0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logw1</code></td>
<td>
<p>log-probabilities or log-importance weights under H1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes numerical estimate of
</p>
<p style="text-align: center;"><code class="reqn">
  BF = Pr(data | H1) / Pr(data | H0),
</code>
</p>

<p>the probability of the data given the "alternative" hypothesis (H1) over
the probability of the data given the "null" hypothesis (H0). This is
also known as a Bayes factor (see Kass &amp; Raftery, 1995). Here we assume
that although these probabilities cannot be computed analytically
because they involve intractable integrals, we can obtain reasonable
estimates of these probabilities with a simple numerical approximation
over some latent variable assuming the prior over this latent variable
is uniform. The inputs are the log-probabilities
</p>
<p style="text-align: center;"><code class="reqn">
  Pr(data, Z0 | H0) = Pr(data | Z0, H0) x Pr(Z0 | H0),
  Pr(data, Z1 | H1) = Pr(data | Z1, H1) x Pr(Z1 | H1),
</code>
</p>

<p>where Pr(Z0 | H0) and Pr(Z1 | H1) are uniform over all Z0 and Z1.
</p>
<p>Alternatively, this function can be viewed as computing an importance
sampling estimate of the Bayes factor; see, for example, R. M. Neal,
"Annealed importance sampling", Statistics and Computing, 2001. This
formulation described above is a special case of importance sampling
when the settings of the latent variable Z0 and A1 are drawn from the
same (uniform) distribution as the prior, Pr(Z0 | H0) and Pr(Z1 | H1),
respectively.
</p>


<h3>Value</h3>

<p>The estimated Bayes factor.
</p>


<h3>Author(s)</h3>

<p>Peter Carbonetto <a href="mailto:peter.carbonetto@gmail.com">peter.carbonetto@gmail.com</a></p>


<h3>References</h3>

<p>P. Carbonetto and M. Stephens (2012). Scalable variational inference
for Bayesian variable selection in regression, and its accuracy in
genetic association studies. <em>Bayesian Analysis</em> <b>7</b>,
73–108.
</p>
<p>R. E. Kass and A. E. Raftery (1995). Bayes Factors. <em>Journal of the
American Statistical Association</em> <b>90</b>, 773–795.
</p>
<p>R. M. Neal (2001). Annealed importance sampling. <em>Statistics and
Computing</em> <b>11</b>, 125–139.
</p>


<h3>See Also</h3>

<p><code>varbvs</code>, <code>normalizelogweights</code></p>


</div>