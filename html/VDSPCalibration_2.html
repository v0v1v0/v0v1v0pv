<div class="container">

<table style="width: 100%;"><tr>
<td>calfun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating the Calibration Equation</h2>

<h3>Description</h3>

<p> Estimates the calibration equation based on CV information</p>


<h3>Usage</h3>

<pre><code class="language-R">calfun(x, y, CVx, CVy = CVx, lambda0 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>old VD measurements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>reference (new) VD measurements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVx</code></td>
<td>
<p>CV% of the old VD measurements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVy</code></td>
<td>
<p>CV% of the new VD measurements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>the CV ratio of the new vs old measurements</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Estimation of the calibration equation. It covers 4 scenarios: Only CVx is known; only CVy is known;  both CVx and CVy are known; and  Only the ratio of CVy to CVx is known.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef </code></td>
<td>
<p>estimated coefficients of the linear function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se </code></td>
<td>
<p>standard errors of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower CI</code></td>
<td>
<p> the lower end of the 95% CI of the regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper CI</code></td>
<td>
<p> the upper end of the 95% CI of the regression coefficients</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Durazo-Arvizu, Ramon; Sempos, Chris;  Tian, Lu</p>


<h3>References</h3>

<p>Tian L., Durazo-Arvizu R. A., Myers G., Brooks S., Sarafin K., and Sempos C. T. (2014), The estimation of calibration equations for variables with heteroscedastic measurement errors, Statist. Med., 33, pages 4420-4436</p>


<h3>Examples</h3>

<pre><code class="language-R">n=100
sigma0=10

beta0=5
beta1=1.2
CVx=0.15
CVy=0.07

lambda0=CVy^2/CVx^2

x0=runif(n, 20, 200)
y0=beta0+beta1*x0+rnorm(n)*sigma0
x=x0+x0*CVx*rnorm(n)
y=y0+y0*CVy*rnorm(n)

fit=calfun(x, y, CVx, CVy, lambda0)
fit

</code></pre>


</div>