<div class="container">

<table style="width: 100%;"><tr>
<td>VcrResponse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The response of an HTTPInteraction</h2>

<h3>Description</h3>

<p>Custom vcr http response object
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>status</code></dt>
<dd>
<p>the status of the response</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>the response headers</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>the response body</p>
</dd>
<dt><code>http_version</code></dt>
<dd>
<p>the HTTP version</p>
</dd>
<dt><code>opts</code></dt>
<dd>
<p>a list</p>
</dd>
<dt><code>adapter_metadata</code></dt>
<dd>
<p>Additional metadata used by a specific VCR adapter</p>
</dd>
<dt><code>hash</code></dt>
<dd>
<p>a list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a boolean</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-VcrResponse-new"><code>VcrResponse$new()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-print"><code>VcrResponse$print()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-to_hash"><code>VcrResponse$to_hash()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-from_hash"><code>VcrResponse$from_hash()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-update_content_length_header"><code>VcrResponse$update_content_length_header()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-get_header"><code>VcrResponse$get_header()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-edit_header"><code>VcrResponse$edit_header()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-delete_header"><code>VcrResponse$delete_header()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-content_encoding"><code>VcrResponse$content_encoding()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-is_compressed"><code>VcrResponse$is_compressed()</code></a>
</p>
</li>
<li> <p><a href="#method-VcrResponse-clone"><code>VcrResponse$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-VcrResponse-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new VcrResponse object
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$new(
  status,
  headers,
  body,
  http_version,
  opts,
  adapter_metadata = NULL,
  disk
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>status</code></dt>
<dd>
<p>the status of the response</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>the response headers</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>the response body</p>
</dd>
<dt><code>http_version</code></dt>
<dd>
<p>the HTTP version</p>
</dd>
<dt><code>opts</code></dt>
<dd>
<p>a list</p>
</dd>
<dt><code>adapter_metadata</code></dt>
<dd>
<p>Additional metadata used by a specific VCR adapter</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>boolean, is body a file on disk</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>VcrResponse</code> object
</p>


<hr>
<a id="method-VcrResponse-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print method for the <code>VcrResponse</code> class
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$print(x, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>self</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>ignored</p>
</dd>
</dl>
</div>


<hr>
<a id="method-VcrResponse-to_hash"></a>



<h4>Method <code>to_hash()</code>
</h4>

<p>Create a hash
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$to_hash()</pre></div>



<h5>Returns</h5>

<p>a list
</p>


<hr>
<a id="method-VcrResponse-from_hash"></a>



<h4>Method <code>from_hash()</code>
</h4>

<p>Get a hash back to an R list
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$from_hash(hash)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>hash</code></dt>
<dd>
<p>a list</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>an <code>VcrResponse</code> object
</p>


<hr>
<a id="method-VcrResponse-update_content_length_header"></a>



<h4>Method <code>update_content_length_header()</code>
</h4>

<p>Updates the Content-Length response header so that
it is accurate for the response body
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$update_content_length_header()</pre></div>



<h5>Returns</h5>

<p>no return; modifies the content length header
</p>


<hr>
<a id="method-VcrResponse-get_header"></a>



<h4>Method <code>get_header()</code>
</h4>

<p>Get a header by name
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$get_header(key)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt>
<dd>
<p>(character) header name to get</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>the header value (if it exists)
</p>


<hr>
<a id="method-VcrResponse-edit_header"></a>



<h4>Method <code>edit_header()</code>
</h4>

<p>Edit a header
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$edit_header(key, value = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt>
<dd>
<p>(character) header name to edit</p>
</dd>
<dt><code>value</code></dt>
<dd>
<p>(character) new value to assign</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>no return; modifies the header in place
</p>


<hr>
<a id="method-VcrResponse-delete_header"></a>



<h4>Method <code>delete_header()</code>
</h4>

<p>Delete a header
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$delete_header(key)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt>
<dd>
<p>(character) header name to delete</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>no return; the header is deleted if it exists
</p>


<hr>
<a id="method-VcrResponse-content_encoding"></a>



<h4>Method <code>content_encoding()</code>
</h4>

<p>Get the content-encoding header value
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$content_encoding()</pre></div>



<h5>Returns</h5>

<p>(character) the content-encoding value
</p>


<hr>
<a id="method-VcrResponse-is_compressed"></a>



<h4>Method <code>is_compressed()</code>
</h4>

<p>Checks if the encoding is one of "gzip" or "deflate"
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$is_compressed()</pre></div>



<h5>Returns</h5>

<p>logical
</p>


<hr>
<a id="method-VcrResponse-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>VcrResponse$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
vcr_configure(dir = tempdir())

# basic example of VcrResponse use
url &lt;- "https://google.com"
(cli &lt;- crul::HttpClient$new(url = url))
(res &lt;- cli$get("get", query = list(q = "stuff")))
(x &lt;- VcrResponse$new(res$status_http(), res$response_headers,
   res$parse("UTF-8"), res$response_headers$status))
x$body
x$status
x$headers
x$http_version
x$to_hash()
x$from_hash(x$to_hash())

# update content length header
## example 1
### content-length header present, but no change
url &lt;- "https://fishbase.ropensci.org"
cli &lt;- crul::HttpClient$new(url = url, headers = list(`Accept-Encoding` = '*'))
res &lt;- cli$get("species/34")
x &lt;- VcrResponse$new(res$status_http(), res$response_headers,
   res$parse("UTF-8"), res$response_headers$status)
x$headers$`content-length`
x$update_content_length_header()
x$headers$`content-length`

## example 2
### no content-length header b/c a transfer-encoding header is included
### and no content-length header allowed if transfer-encoding header
### used (via rfc7230)
url &lt;- "https://google.com"
cli &lt;- crul::HttpClient$new(url = url)
res &lt;- cli$get()
x &lt;- VcrResponse$new(res$status_http(), res$response_headers,
   rawToChar(res$content), res$response_headers$status)
x$headers$`content-length` # = NULL
x$update_content_length_header() # no change, b/c header doesn't exist
x$headers$`content-length` # = NULL

## example 3
### content-length header present, and does change
body &lt;- " Hello World "
x &lt;- VcrResponse$new(200, list('content-length'=nchar(body)),
  body, "HTTP/2")
x$headers$`content-length` # = 13
x$body &lt;- gsub("^\\s|\\s$", "", x$body)
x$headers$`content-length` # = 13
x$update_content_length_header()
x$headers$`content-length` # = 11

# check if body is compressed
url &lt;- "https://fishbase.ropensci.org"
(cli &lt;- crul::HttpClient$new(url = url))
(res &lt;- cli$get("species/3"))
res$response_headers
(x &lt;- VcrResponse$new(res$status_http(), res$response_headers,
   res$parse("UTF-8"), res$response_headers$status))
x$content_encoding()
x$is_compressed()

# with disk
url &lt;- "https://google.com"
(cli &lt;- crul::HttpClient$new(url = url))
f &lt;- tempfile()
(res &lt;- cli$get("get", query = list(q = "stuff"), disk = f))
(x &lt;- VcrResponse$new(res$status_http(), res$response_headers,
   f, res$response_headers$status, disk = TRUE))

## End(Not run)
</code></pre>


</div>