<div class="container">

<table style="width: 100%;"><tr>
<td>serial.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for serially correlated errors</h2>

<h3>Description</h3>

<p>This function computes the multivariate Portmanteau- and Breusch-Godfrey
test for serially correlated errors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">serial.test(x, lags.pt = 16, lags.bg = 5, type = c("PT.asymptotic",
"PT.adjusted", "BG", "ES") )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class ‘<code>varest</code>’; generated by
<code>VAR()</code>, or an object of class ‘<code>vec2var</code>’;
generated by <code>vec2var()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags.pt</code></td>
<td>
<p>An integer specifying the lags to be used for the
Portmanteau statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags.bg</code></td>
<td>
<p>An integer specifying the lags to be used for the
Breusch-Godfrey statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character, the type of test. The default is an asymptotic
Portmanteau test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Portmanteau statistic for testing the absence of up to the order <code class="reqn">h</code>
serially correlated disturbances in a stable VAR(p) is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
    Q_h = T \sum_{j = 1}^h
    tr(\hat{C}_j'\hat{C}_0^{-1}\hat{C}_j\hat{C}_0^{-1}) \quad ,
  </code>
</p>

<p>where <code class="reqn">\hat{C}_i = \frac{1}{T}\sum_{t = i + 1}^T \bold{\hat{u}}_t
    \bold{\hat{u}}_{t - i}'</code>. The test statistic is approximately
distributed as <code class="reqn">\chi^2(K^2(h - p))</code>. This test statistic is
choosen by setting <code>type = "PT.asymptotic"</code>. For smaller sample sizes
and/or values of <code class="reqn">h</code> that are not sufficiently large, a corrected
test statistic is computed as:
</p>
<p style="text-align: center;"><code class="reqn">
    Q_h^* = T^2 \sum_{j = 1}^h
    \frac{1}{T - j}tr(\hat{C}_j'\hat{C}_0^{-1}\hat{C}_j\hat{C}_0^{-1}) \quad ,
  </code>
</p>

<p>This test statistic can be accessed, if <code>type = "PT.adjusted"</code> is
set.<br></p>
<p>The Breusch-Godfrey LM-statistic is based upon the following auxiliary
regressions:
</p>
<p style="text-align: center;"><code class="reqn">
    \bold{\hat{u}}_t = A_1 \bold{y}_{t-1} + \ldots + A_p\bold{y}_{t-p} +
    CD_t + B_1\bold{\hat{u}}_{t-1} + \ldots + B_h\bold{\hat{u}}_{t-h} +
    \bold{\varepsilon}_t   
  </code>
</p>

<p>The null hypothesis is: <code class="reqn">H_0: B_1 = \ldots = B_h = 0</code> and
correspondingly the alternative hypothesis is of the form <code class="reqn">H_1:
    \exists \; B_i \ne 0</code> for <code class="reqn">i = 1, 2, \ldots, h</code>. The test statistic
is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
    LM_h = T(K - tr(\tilde{\Sigma}_R^{-1}\tilde{\Sigma}_e))  \quad ,
  </code>
</p>

<p>where <code class="reqn">\tilde{\Sigma}_R</code> and <code class="reqn">\tilde{\Sigma}_e</code> assign the
residual covariance matrix of the restricted and unrestricted
model, respectively. The test statistic <code class="reqn">LM_h</code> is distributed as
<code class="reqn">\chi^2(hK^2)</code>. This test statistic is calculated if <code>type =
    "BG"</code> is used.<br></p>
<p>Edgerton and Shukur (1999) proposed a small sample correction, which
is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
    LMF_h = \frac{1 - (1 - R_r^2)^{1/r}}{(1 - R_r^2)^{1/r}} \frac{Nr -
      q}{K m} \quad ,
  </code>
</p>

<p>with <code class="reqn">R_r^2 = 1 - |\tilde{\Sigma}_e | / |\tilde{\Sigma}_R|</code>,
<code class="reqn">r = ((K^2m^2 - 4)/(K^2 + m^2 - 5))^{1/2}</code>, <code class="reqn">q = 1/2 K m - 1</code>
and <code class="reqn">N = T - K - m - 1/2(K - m + 1)</code>, whereby <code class="reqn">n</code> is the
number of regressors in the original system and <code class="reqn">m = Kh</code>. The
modified test statistic is distributed as <code class="reqn">F(hK^2, int(Nr -
    q))</code>. This modified statistic will be returned, if <code>type =
    "ES"</code> is provided in the call to <code>serial()</code>.    
</p>


<h3>Value</h3>

<p>A list with class attribute ‘<code>varcheck</code>’ holding the
following elements:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>A matrix with the residuals of the VAR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.mul</code></td>
<td>
<p>A list with objects of class attribute ‘<code>htest</code>’
containing the multivariate Portmanteau-statistic (asymptotic and
adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LMh</code></td>
<td>
<p>An object with class attribute ‘<code>htest</code>’
containing the Breusch-Godfrey LM-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LMFh</code></td>
<td>
<p>An object with class attribute ‘<code>htest</code>’
containing the Edgerton-Shukur F-statistic.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function was named <code>serial</code> in earlier versions of package
<span class="pkg">vars</span>; it is now deprecated. See <code>vars-deprecated</code> too.
</p>


<h3>Author(s)</h3>

<p>Bernhard Pfaff</p>


<h3>References</h3>

<p>Breusch, T . S. (1978), Testing for autocorrelation in dynamic linear
models, <em>Australian Economic Papers</em>, <b>17</b>: 334-355.
</p>
<p>Edgerton, D. and Shukur, G. (1999), Testing autocorrelation in a
system perspective, <em>Econometric Reviews</em>, <b>18</b>: 43-386.
</p>
<p>Godfrey, L. G. (1978), Testing for higher order serial correlation in
regression equations when the regressors include lagged dependent
variables, <em>Econometrica</em>, <b>46</b>: 1303-1313.
</p>
<p>Hamilton, J. (1994), <em>Time Series Analysis</em>, Princeton
University Press, Princeton.
</p>
<p>Lütkepohl, H. (2006), <em>New Introduction to Multiple Time Series
Analysis</em>, Springer, New York.
</p>


<h3>See Also</h3>

<p><code>VAR</code>, <code>vec2var</code>, <code>plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Canada)
var.2c &lt;- VAR(Canada, p = 2, type = "const")
serial.test(var.2c, lags.pt = 16, type = "PT.adjusted")
</code></pre>


</div>