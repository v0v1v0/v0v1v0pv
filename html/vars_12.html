<div class="container">

<table style="width: 100%;"><tr>
<td>causality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Causality Analysis</h2>

<h3>Description</h3>

<p>Computes the test statistics for Granger- and Instantaneous causality
for a VAR(p). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">causality(x, cause = NULL, vcov.=NULL, boot=FALSE, boot.runs=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class ‘<code>varest</code>’; generated by
<code>VAR()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cause</code></td>
<td>
<p>A character vector of the cause variable(s). If not set,
then the variable in the first column of <code>x$y</code> is used as cause
variable and a warning is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.</code></td>
<td>
<p>a specification of the covariance matrix of the estimated coefficients. This can be
specified as a matrix or as a function yielding a matrix when applied to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Logical. Whether a wild bootstrap procedure should be used to compute the critical values. Default is no</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.runs</code></td>
<td>
<p>Number of bootstrap replications if boot=TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two causality tests are implemented. The first is a F-type
Granger-causality test and the second is a Wald-type test that is
characterized by testing for nonzero correlation between the error
processes of the cause and effect variables. For both tests the vector
of endogenous variables <code class="reqn">\bold{y}_t</code> is split into two subvectors
<code class="reqn">\bold{y}_{1t}</code> and <code class="reqn">\bold{y}_{2t}</code> with dimensions <code class="reqn">(K_1
    \times 1)</code> and <code class="reqn">(K_2 \times 1)</code> with <code class="reqn">K = K_1 + K_2</code>.<br>
For the rewritten VAR(p):
</p>
<p style="text-align: center;"><code class="reqn">
    [\bold{y}_{1t} , \bold{y}_{2t}] = \sum_{i=1}^p [\bold{\alpha}_{11, i}' ,
    \bold{\alpha}_{12, i}' | \bold{\alpha}_{21, i}' , \bold{\alpha}_{22,
      i}'][\bold{y}_{1,t-i}, \bold{y}_{2, t-i}] + CD_t + [\bold{u}_{1t},
    \bold{u}_{2t}]  \quad ,
  </code>
</p>

<p>the null hypothesis that the subvector <code class="reqn">\bold{y}_{1t}</code> does not
Granger-cause <code class="reqn">\bold{y}_{2t}</code>, is defined as
<code class="reqn">\bold{\alpha}_{21, i} = 0</code> for <code class="reqn">i = 1, 2, \ldots, p</code>. The
alternative is: <code class="reqn">\exists \; \bold{\alpha}_{21,i} \ne 0</code> for <code class="reqn">i =
    1, 2, \ldots, p</code>. The test statistic is distributed as <code class="reqn">F(p K_1
    K_2, KT - n^*)</code>, with <code class="reqn">n^*</code> equal to the total number of
parameters in the above VAR(p) (including deterministic
regressors).<br>
The null hypothesis for instantaneous causality is defined as:
<code class="reqn">H_0: C \bold{\sigma} = 0</code>, where <code class="reqn">C</code> is a <code class="reqn">(N \times K(K
    + 1)/2)</code> matrix of rank <code class="reqn">N</code> selecting the relevant co-variances of
<code class="reqn">\bold{u}_{1t}</code> and <code class="reqn">\bold{u}_{2t}</code>; <code class="reqn">\bold{\sigma} =
    vech(\Sigma_u)</code>. The Wald statistic is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
    \lambda_W = T \tilde{\bold{\sigma}}'C'[2 C D_{K}^{+}(\tilde{\Sigma}_u
    \otimes \tilde{\Sigma}_u) D_{K}^{+'} C']^{-1} C
    \tilde{\bold{\sigma}}  \quad , 
  </code>
</p>

<p>hereby assigning the Moore-Penrose inverse of the duplication matrix
<code class="reqn">D_K</code> with <code class="reqn">D_{K}^{+}</code> and <code class="reqn">\tilde{\Sigma}_u =
    \frac{1}{T}\sum_{t=1}^T \hat{\bold{u}}_t \hat{\bold{u}}_t'</code>. The
duplication matrix <code class="reqn">D_K</code> has dimension <code class="reqn">(K^2 \times
    \frac{1}{2}K(K + 1))</code> and is defined such that for any symmetric
<code class="reqn">(K \times K)</code> matrix A, <code class="reqn">vec(A) = D_K vech(A)</code> holds. The
test statistic <code class="reqn">\lambda_W</code> is asymptotically distributed as
<code class="reqn">\chi^2(N)</code>.
</p>
<p>Fot the Granger causality test, a robust covariance-matrix estimator can be 
used in case of heteroskedasticity through argument <code>vcov.</code> It can be either a pre-computed matrix or
a function for extracting the covariance matrix. See <code>vcovHC</code>
from package <span class="pkg">sandwich</span> for further details. 
</p>
<p>A wild bootstrap computation (imposing the restricted model as null)
of the p values is available through argument <code>boot</code> and <code>boot.runs</code> following Hafner and Herwartz (2009). 
</p>


<h3>Value</h3>

<p>A list with elements of class ‘<code>htest</code>’:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>Granger</code></td>
<td>
<p>The result of the Granger-causality test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Instant</code></td>
<td>
<p>The result of the instantaneous causality test.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Moore-Penrose inverse matrix is computed with the function
<code>ginv</code> contained in the package ‘<code>MASS</code>’.<br>
The Granger-causality test is problematic if some of the
variables are nonstationary. In that case the usual asymptotic
distribution of the test statistic may not be valid under the null
hypothesis.  
</p>


<h3>Author(s)</h3>

<p>Bernhard Pfaff</p>


<h3>References</h3>

<p>Granger, C. W. J. (1969), Investigating causal relations by
econometric models and cross-spectral methods, <em>Econometrica</em>,
<b>37</b>: 424-438. 
</p>
<p>Hafner, C. M. and Herwartz, H. (2009) Testing for linear vector autoregressive 
dynamics under multivariate generalized autoregressive heteroskedasticity, 
<em>Statistica Neerlandica</em>, <b>63</b>: 294-323
</p>
<p>Hamilton, J. (1994), <em>Time Series Analysis</em>, Princeton
University Press, Princeton.
</p>
<p>Lütkepohl, H. (2006), <em>New Introduction to Multiple Time Series
Analysis</em>, Springer, New York.
</p>
<p>Venables, W. N. and B. D. Ripley (2002), <em>Modern Applied
Statistics with S</em>, 4th edition, Springer, New York.
</p>
<p>Zeileis, A. (2006) Object-Oriented Computation of Sandwich Estimators
<em>Journal of Statistical Software</em>, <b>16</b>, 1-16
</p>


<h3>See Also</h3>

<p><code>VAR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Canada)
var.2c &lt;- VAR(Canada, p = 2, type = "const")
causality(var.2c, cause = "e")

#use a robust HC variance-covariance matrix for the Granger test:
causality(var.2c, cause = "e", vcov.=vcovHC(var.2c))

#use a wild-bootstrap procedure to for the Granger test
## Not run: causality(var.2c, cause = "e", boot=TRUE, boot.runs=1000)
</code></pre>


</div>